head	1.1;
access;
symbols;
locks
	cberry:1.1; strict;
comment	@# @;


1.1
date	2000.11.15.19.53.14;	author cberry;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Initial revision
@
text
@"residuals.bqtl"<-
    function(object)
{
    coefs <- coef(object)
    coef.names <- names(coefs)[-1]        # drop intercept
    bqtl.call <- match.call(bqtl,object$call)  
    bqtl.terms <- terms(bqtl.call$reg.formula)
    data.obj <- bqtl.call[["ana.obj"]]
    data <- substitute(data.obj$data)
    model.fr <-
        model.frame(bqtl.terms,data=eval(data),
                    na.action=na.omit)
    model.mat <- model.matrix(delete.response(bqtl.terms),model.fr)
    response <- model.extract(model.fr,"response")
    
    coef.order <-  1 +                   #assume intercept is first
        match(dimnames(model.mat)[[2]][-1],coef.names)
    
    resids <-   response -model.mat %*% as.matrix( coefs[c(1,coef.order)] )
    dimnames(resids)[[2]] <- "residuals"
    resids
    
}
@
